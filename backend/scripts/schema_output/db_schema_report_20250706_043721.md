# Database Schema Report
Generated at: 2025-07-06T04:37:20.705067

## Summary
- Total Tables: 52
- Total Foreign Key Relationships: 113
- Total Model Relationships: 0

## Tables

### alembic_version

#### Columns
- `version_num`: VARCHAR(32) (NOT NULL)

#### Primary Keys
- `version_num`

---

### alert_types

#### Columns
- `id`: INTEGER (NOT NULL) (AUTO)
- `name`: VARCHAR(50) (NOT NULL)
- `description`: VARCHAR(255) (NULL)
- `category`: VARCHAR(50) (NULL)
- `icon_name`: VARCHAR(50) (NULL)
- `color_code`: VARCHAR(7) (NULL)
- `is_active`: BOOLEAN (NOT NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)

#### Primary Keys
- `id`

#### Indexes
- `ix_alert_types_category` on `category`
- `ix_alert_types_name` on `name` (UNIQUE)

---

### alerts

#### Columns
- `id`: UUID (NOT NULL)
- `alert_subtype`: VARCHAR(50) (NULL)
- `severity`: VARCHAR(20) (NOT NULL)
- `title`: VARCHAR(200) (NOT NULL)
- `message`: TEXT (NULL)
- `alert_data`: TEXT (NULL)
- `acknowledged_at`: TIMESTAMP (NULL)
- `resolved_at`: TIMESTAMP (NULL)
- `priority`: INTEGER (NOT NULL)
- `escalation_level`: INTEGER (NOT NULL)
- `user_id`: UUID (NULL)
- `cared_person_id`: UUID (NULL)
- `device_id`: UUID (NULL)
- `event_id`: UUID (NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)
- `status_type_id`: INTEGER (NULL)
- `alert_type_id`: INTEGER (NOT NULL)

#### Primary Keys
- `id`

#### Foreign Keys
- `alert_type_id` → `alert_types.id`
- `cared_person_id` → `cared_persons.id`
- `device_id` → `devices.id`
- `event_id` → `events.id`
- `status_type_id` → `status_types.id`
- `user_id` → `users.id`

#### Indexes
- `ix_alerts_alert_subtype` on `alert_subtype`
- `ix_alerts_alert_type_id` on `alert_type_id`
- `ix_alerts_id` on `id`
- `ix_alerts_status_type_id` on `status_type_id`

---

### allergies

#### Columns
- `id`: UUID (NOT NULL)
- `cared_person_id`: UUID (NOT NULL)
- `allergen_name`: VARCHAR (NOT NULL)
- `allergy_type`: VARCHAR (NULL)
- `severity`: VARCHAR (NULL)
- `reaction_description`: TEXT (NULL)
- `diagnosis_date`: DATE (NULL)
- `is_active`: BOOLEAN (NOT NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)

#### Primary Keys
- `id`

#### Foreign Keys
- `cared_person_id` → `cared_persons.id`

---

### billing_records

#### Columns
- `invoice_number`: VARCHAR(50) (NOT NULL)
- `billing_type`: VARCHAR(50) (NOT NULL)
- `description`: TEXT (NULL)
- `amount`: INTEGER (NOT NULL)
- `currency`: VARCHAR(3) (NOT NULL)
- `tax_amount`: INTEGER (NOT NULL)
- `total_amount`: INTEGER (NOT NULL)
- `billing_date`: DATE (NOT NULL)
- `due_date`: DATE (NULL)
- `paid_date`: DATE (NULL)
- `payment_method`: VARCHAR(50) (NULL)
- `transaction_id`: VARCHAR(100) (NULL)
- `user_id`: UUID (NULL)
- `institution_id`: INTEGER (NULL)
- `service_subscription_id`: INTEGER (NULL)
- `user_package_id`: UUID (NULL)
- `id`: INTEGER (NOT NULL) (AUTO)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)
- `is_active`: BOOLEAN (NOT NULL)
- `status_type_id`: INTEGER (NULL)

#### Primary Keys
- `id`

#### Foreign Keys
- `institution_id` → `institutions.id`
- `service_subscription_id` → `service_subscriptions.id`
- `status_type_id` → `status_types.id`
- `user_id` → `users.id`
- `user_package_id` → `user_packages.id`

#### Indexes
- `ix_billing_records_billing_type` on `billing_type`
- `ix_billing_records_id` on `id`
- `ix_billing_records_invoice_number` on `invoice_number` (UNIQUE)
- `ix_billing_records_status_type_id` on `status_type_id`

---

### care_types

#### Columns
- `id`: INTEGER (NOT NULL) (AUTO)
- `name`: VARCHAR(50) (NOT NULL)
- `description`: VARCHAR(255) (NULL)
- `is_active`: BOOLEAN (NOT NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)

#### Primary Keys
- `id`

#### Indexes
- `ix_care_types_name` on `name` (UNIQUE)

---

### cared_person_institutions

#### Columns
- `cared_person_id`: UUID (NOT NULL)
- `institution_id`: INTEGER (NOT NULL)
- `start_date`: DATE (NOT NULL)
- `end_date`: DATE (NULL)
- `schedule`: TEXT (NULL)
- `frequency`: VARCHAR(50) (NULL)
- `duration_hours`: DOUBLE PRECISION (NULL)
- `cost_per_session`: INTEGER (NULL)
- `payment_frequency`: VARCHAR(50) (NULL)
- `insurance_coverage`: BOOLEAN (NOT NULL)
- `insurance_provider`: VARCHAR(100) (NULL)
- `primary_doctor`: VARCHAR(100) (NULL)
- `medical_notes`: TEXT (NULL)
- `treatment_plan`: TEXT (NULL)
- `is_primary`: BOOLEAN (NOT NULL)
- `registered_by`: UUID (NULL)
- `registered_at`: TIMESTAMP (NOT NULL)
- `notes`: TEXT (NULL)
- `id`: INTEGER (NOT NULL) (AUTO)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)
- `status_type_id`: INTEGER (NULL)
- `service_type_id`: INTEGER (NOT NULL)

#### Primary Keys
- `id`

#### Foreign Keys
- `cared_person_id` → `cared_persons.id`
- `institution_id` → `institutions.id`
- `registered_by` → `users.id`
- `service_type_id` → `service_types.id`
- `status_type_id` → `status_types.id`

#### Indexes
- `ix_cared_person_institutions_cared_person_id` on `cared_person_id`
- `ix_cared_person_institutions_id` on `id`
- `ix_cared_person_institutions_institution_id` on `institution_id`
- `ix_cared_person_institutions_status_type_id` on `status_type_id`

---

### cared_persons

#### Columns
- `id`: UUID (NOT NULL)
- `first_name`: VARCHAR(100) (NOT NULL)
- `last_name`: VARCHAR(100) (NOT NULL)
- `date_of_birth`: DATE (NULL)
- `gender`: VARCHAR(20) (NULL)
- `identification_number`: VARCHAR(50) (NULL)
- `phone`: VARCHAR(20) (NULL)
- `email`: VARCHAR(100) (NULL)
- `emergency_contact`: VARCHAR(100) (NULL)
- `emergency_phone`: VARCHAR(20) (NULL)
- `blood_type`: VARCHAR(10) (NULL)
- `care_level`: VARCHAR(50) (NULL)
- `special_needs`: TEXT (NULL)
- `mobility_level`: VARCHAR(50) (NULL)
- `address`: TEXT (NULL)
- `latitude`: DOUBLE PRECISION (NULL)
- `longitude`: DOUBLE PRECISION (NULL)
- `user_id`: UUID (NULL)
- `institution_id`: INTEGER (NULL)
- `medical_contact_name`: VARCHAR(100) (NULL)
- `medical_contact_phone`: VARCHAR(20) (NULL)
- `family_contact_name`: VARCHAR(100) (NULL)
- `family_contact_phone`: VARCHAR(20) (NULL)
- `medical_notes`: TEXT (NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)
- `is_active`: BOOLEAN (NOT NULL)
- `care_type_id`: INTEGER (NULL)

#### Primary Keys
- `id`

#### Foreign Keys
- `care_type_id` → `care_types.id`
- `institution_id` → `institutions.id`
- `user_id` → `users.id`

#### Indexes
- `cared_persons_identification_number_key` on `identification_number` (UNIQUE)
- `ix_cared_persons_care_type_id` on `care_type_id`
- `ix_cared_persons_id` on `id`

---

### caregiver_assignment_types

#### Columns
- `id`: INTEGER (NOT NULL) (AUTO)
- `name`: VARCHAR(50) (NOT NULL)
- `description`: VARCHAR(255) (NULL)
- `category`: VARCHAR(50) (NULL)
- `is_active`: BOOLEAN (NOT NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)

#### Primary Keys
- `id`

#### Indexes
- `ix_caregiver_assignment_types_category` on `category`
- `ix_caregiver_assignment_types_name` on `name` (UNIQUE)

---

### caregiver_assignments

#### Columns
- `caregiver_id`: UUID (NOT NULL)
- `cared_person_id`: UUID (NOT NULL)
- `start_date`: DATE (NOT NULL)
- `end_date`: DATE (NULL)
- `schedule`: TEXT (NULL)
- `responsibilities`: TEXT (NULL)
- `special_requirements`: TEXT (NULL)
- `hourly_rate`: INTEGER (NULL)
- `payment_frequency`: VARCHAR(50) (NULL)
- `is_insured`: BOOLEAN (NOT NULL)
- `insurance_provider`: VARCHAR(100) (NULL)
- `client_rating`: INTEGER (NULL)
- `client_feedback`: TEXT (NULL)
- `caregiver_self_rating`: INTEGER (NULL)
- `caregiver_notes`: TEXT (NULL)
- `primary_doctor`: VARCHAR(100) (NULL)
- `medical_contact`: VARCHAR(100) (NULL)
- `emergency_protocol`: TEXT (NULL)
- `is_primary`: BOOLEAN (NOT NULL)
- `assigned_by`: UUID (NULL)
- `assigned_at`: TIMESTAMP (NOT NULL)
- `notes`: TEXT (NULL)
- `id`: INTEGER (NOT NULL) (AUTO)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)
- `status_type_id`: INTEGER (NULL)
- `caregiver_assignment_type_id`: INTEGER (NOT NULL)

#### Primary Keys
- `id`

#### Foreign Keys
- `assigned_by` → `users.id`
- `cared_person_id` → `cared_persons.id`
- `caregiver_assignment_type_id` → `caregiver_assignment_types.id`
- `caregiver_id` → `users.id`
- `status_type_id` → `status_types.id`

#### Indexes
- `ix_caregiver_assignments_cared_person_id` on `cared_person_id`
- `ix_caregiver_assignments_caregiver_assignment_type_id` on `caregiver_assignment_type_id`
- `ix_caregiver_assignments_caregiver_id` on `caregiver_id`
- `ix_caregiver_assignments_id` on `id`
- `ix_caregiver_assignments_status_type_id` on `status_type_id`

---

### caregiver_institutions

#### Columns
- `caregiver_id`: UUID (NOT NULL)
- `institution_id`: INTEGER (NOT NULL)
- `contract_type`: VARCHAR(50) (NOT NULL)
- `start_date`: DATE (NOT NULL)
- `end_date`: DATE (NULL)
- `position`: VARCHAR(100) (NULL)
- `department`: VARCHAR(100) (NULL)
- `work_schedule`: TEXT (NULL)
- `hourly_rate`: INTEGER (NULL)
- `salary`: INTEGER (NULL)
- `benefits`: TEXT (NULL)
- `is_primary`: BOOLEAN (NOT NULL)
- `hired_by`: UUID (NULL)
- `hired_at`: TIMESTAMP (NOT NULL)
- `notes`: TEXT (NULL)
- `id`: INTEGER (NOT NULL) (AUTO)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)
- `status_type_id`: INTEGER (NULL)
- `relationship_type_id`: INTEGER (NULL)

#### Primary Keys
- `id`

#### Foreign Keys
- `caregiver_id` → `users.id`
- `hired_by` → `users.id`
- `institution_id` → `institutions.id`
- `relationship_type_id` → `relationship_types.id`
- `status_type_id` → `status_types.id`

#### Indexes
- `ix_caregiver_institutions_caregiver_id` on `caregiver_id`
- `ix_caregiver_institutions_id` on `id`
- `ix_caregiver_institutions_institution_id` on `institution_id`
- `ix_caregiver_institutions_relationship_type_id` on `relationship_type_id`
- `ix_caregiver_institutions_status_type_id` on `status_type_id`

---

### caregiver_reviews

#### Columns
- `id`: UUID (NOT NULL)
- `caregiver_id`: UUID (NOT NULL)
- `reviewer_id`: UUID (NOT NULL)
- `cared_person_id`: UUID (NULL)
- `caregiver_score_id`: UUID (NULL)
- `rating`: INTEGER (NOT NULL)
- `comment`: TEXT (NULL)
- `categories`: JSONB (NULL)
- `is_recommended`: BOOLEAN (NOT NULL)
- `service_date`: DATE (NULL)
- `service_hours`: DOUBLE PRECISION (NULL)
- `is_verified`: BOOLEAN (NOT NULL)
- `is_public`: BOOLEAN (NOT NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NULL)
- `is_active`: BOOLEAN (NOT NULL)
- `service_type_id`: INTEGER (NULL)

#### Primary Keys
- `id`

#### Foreign Keys
- `cared_person_id` → `cared_persons.id`
- `caregiver_id` → `users.id`
- `caregiver_score_id` → `caregiver_scores.id`
- `reviewer_id` → `users.id`
- `service_type_id` → `service_types.id`

#### Indexes
- `ix_caregiver_reviews_cared_person_id` on `cared_person_id`
- `ix_caregiver_reviews_caregiver_id` on `caregiver_id`
- `ix_caregiver_reviews_caregiver_score_id` on `caregiver_score_id`
- `ix_caregiver_reviews_id` on `id`
- `ix_caregiver_reviews_reviewer_id` on `reviewer_id`

---

### caregiver_scores

#### Columns
- `id`: UUID (NOT NULL)
- `caregiver_id`: UUID (NOT NULL)
- `overall_score`: DOUBLE PRECISION (NULL)
- `experience_score`: DOUBLE PRECISION (NULL)
- `quality_score`: DOUBLE PRECISION (NULL)
- `reliability_score`: DOUBLE PRECISION (NULL)
- `availability_score`: DOUBLE PRECISION (NULL)
- `total_reviews`: INTEGER (NOT NULL)
- `total_recommendations`: INTEGER (NOT NULL)
- `total_services`: INTEGER (NOT NULL)
- `total_hours`: INTEGER (NOT NULL)
- `avg_response_time`: INTEGER (NULL)
- `punctuality_rate`: DOUBLE PRECISION (NULL)
- `completion_rate`: DOUBLE PRECISION (NULL)
- `is_identity_verified`: BOOLEAN (NOT NULL)
- `is_background_checked`: BOOLEAN (NOT NULL)
- `is_references_verified`: BOOLEAN (NOT NULL)
- `last_calculated`: TIMESTAMP (NULL)
- `last_review`: TIMESTAMP (NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)
- `is_active`: BOOLEAN (NOT NULL)

#### Primary Keys
- `id`

#### Foreign Keys
- `caregiver_id` → `users.id`

#### Indexes
- `ix_caregiver_scores_caregiver_id` on `caregiver_id`
- `ix_caregiver_scores_id` on `id`

---

### debug_events

#### Columns
- `event_type`: VARCHAR(50) (NOT NULL)
- `event_subtype`: VARCHAR(50) (NULL)
- `severity`: VARCHAR(20) (NOT NULL)
- `event_data`: TEXT (NULL)
- `message`: TEXT (NULL)
- `stack_trace`: TEXT (NULL)
- `source`: VARCHAR(100) (NULL)
- `test_session`: VARCHAR(100) (NULL)
- `environment`: VARCHAR(50) (NULL)
- `event_time`: TIMESTAMP (NOT NULL)
- `processed_at`: TIMESTAMP (NULL)
- `user_id`: UUID (NULL)
- `cared_person_id`: UUID (NULL)
- `device_id`: UUID (NULL)
- `id`: INTEGER (NOT NULL) (AUTO)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)
- `is_active`: BOOLEAN (NOT NULL)

#### Primary Keys
- `id`

#### Foreign Keys
- `cared_person_id` → `cared_persons.id`
- `device_id` → `devices.id`
- `user_id` → `users.id`

#### Indexes
- `ix_debug_events_event_subtype` on `event_subtype`
- `ix_debug_events_event_type` on `event_type`
- `ix_debug_events_id` on `id`

---

### device_configs

#### Columns
- `device_id`: UUID (NOT NULL)
- `config_type`: VARCHAR(50) (NOT NULL)
- `config_name`: VARCHAR(100) (NOT NULL)
- `config_data`: TEXT (NULL)
- `description`: TEXT (NULL)
- `is_active`: BOOLEAN (NOT NULL)
- `is_default`: BOOLEAN (NOT NULL)
- `version`: VARCHAR(20) (NULL)
- `applied_at`: TIMESTAMP (NULL)
- `applied_by`: UUID (NULL)
- `id`: INTEGER (NOT NULL) (AUTO)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)

#### Primary Keys
- `id`

#### Foreign Keys
- `applied_by` → `users.id`
- `device_id` → `devices.id`

#### Indexes
- `ix_device_configs_config_type` on `config_type`
- `ix_device_configs_device_id` on `device_id`
- `ix_device_configs_id` on `id`

---

### device_types

#### Columns
- `id`: INTEGER (NOT NULL) (AUTO)
- `name`: VARCHAR(50) (NOT NULL)
- `description`: VARCHAR(255) (NULL)
- `category`: VARCHAR(50) (NULL)
- `icon_name`: VARCHAR(50) (NULL)
- `color_code`: VARCHAR(7) (NULL)
- `is_active`: BOOLEAN (NOT NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)

#### Primary Keys
- `id`

#### Indexes
- `ix_device_types_category` on `category`
- `ix_device_types_name` on `name` (UNIQUE)

---

### devices

#### Columns
- `id`: UUID (NOT NULL)
- `device_id`: VARCHAR(100) (NOT NULL)
- `name`: VARCHAR(255) (NOT NULL)
- `type`: VARCHAR(50) (NOT NULL)
- `location`: VARCHAR(255) (NULL)
- `model`: VARCHAR(100) (NULL)
- `manufacturer`: VARCHAR(100) (NULL)
- `serial_number`: VARCHAR(100) (NULL)
- `battery_level`: INTEGER (NULL)
- `signal_strength`: INTEGER (NULL)
- `last_seen`: TIMESTAMP (NULL)
- `location_description`: TEXT (NULL)
- `latitude`: DOUBLE PRECISION (NULL)
- `longitude`: DOUBLE PRECISION (NULL)
- `altitude`: DOUBLE PRECISION (NULL)
- `settings`: TEXT (NULL)
- `firmware_version`: VARCHAR(50) (NULL)
- `hardware_version`: VARCHAR(50) (NULL)
- `user_id`: UUID (NULL)
- `cared_person_id`: UUID (NULL)
- `institution_id`: INTEGER (NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)
- `is_active`: BOOLEAN (NOT NULL)
- `status_type_id`: INTEGER (NULL)
- `device_type_id`: INTEGER (NULL)

#### Primary Keys
- `id`

#### Foreign Keys
- `cared_person_id` → `cared_persons.id`
- `device_type_id` → `device_types.id`
- `institution_id` → `institutions.id`
- `status_type_id` → `status_types.id`
- `user_id` → `users.id`

#### Indexes
- `devices_serial_number_key` on `serial_number` (UNIQUE)
- `ix_devices_device_id` on `device_id` (UNIQUE)
- `ix_devices_device_type_id` on `device_type_id`
- `ix_devices_id` on `id`
- `ix_devices_status_type_id` on `status_type_id`

---

### diagnoses

#### Columns
- `id`: UUID (NOT NULL)
- `cared_person_id`: UUID (NOT NULL)
- `diagnosis_name`: VARCHAR(255) (NOT NULL)
- `description`: TEXT (NULL)
- `severity_level`: VARCHAR(50) (NULL)
- `diagnosis_date`: TIMESTAMP (NULL)
- `doctor_name`: VARCHAR(255) (NULL)
- `medical_notes`: TEXT (NULL)
- `cie10_code`: VARCHAR(20) (NULL)
- `attachments`: JSONB (NULL)
- `is_active`: BOOLEAN (NOT NULL)
- `created_by_id`: UUID (NOT NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_by_id`: UUID (NULL)
- `updated_at`: TIMESTAMP (NULL)

#### Primary Keys
- `id`

#### Foreign Keys
- `cared_person_id` → `cared_persons.id`
- `created_by_id` → `users.id`
- `updated_by_id` → `users.id`

#### Indexes
- `ix_diagnoses_id` on `id`

---

### emergency_protocols

#### Columns
- `name`: VARCHAR(200) (NOT NULL)
- `protocol_type`: VARCHAR(50) (NOT NULL)
- `crisis_type`: VARCHAR(50) (NOT NULL)
- `description`: TEXT (NULL)
- `steps`: TEXT (NULL)
- `contacts`: TEXT (NULL)
- `trigger_conditions`: TEXT (NULL)
- `severity_threshold`: VARCHAR(20) (NOT NULL)
- `is_active`: BOOLEAN (NOT NULL)
- `is_default`: BOOLEAN (NOT NULL)
- `institution_id`: INTEGER (NULL)
- `id`: INTEGER (NOT NULL) (AUTO)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)

#### Primary Keys
- `id`

#### Foreign Keys
- `institution_id` → `institutions.id`

#### Indexes
- `ix_emergency_protocols_crisis_type` on `crisis_type`
- `ix_emergency_protocols_id` on `id`
- `ix_emergency_protocols_name` on `name`
- `ix_emergency_protocols_protocol_type` on `protocol_type`

---

### event_types

#### Columns
- `id`: INTEGER (NOT NULL) (AUTO)
- `name`: VARCHAR(50) (NOT NULL)
- `description`: VARCHAR(255) (NULL)
- `category`: VARCHAR(50) (NULL)
- `icon_name`: VARCHAR(50) (NULL)
- `color_code`: VARCHAR(7) (NULL)
- `is_active`: BOOLEAN (NOT NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)

#### Primary Keys
- `id`

#### Indexes
- `ix_event_types_category` on `category`
- `ix_event_types_name` on `name` (UNIQUE)

---

### events

#### Columns
- `id`: UUID (NOT NULL)
- `event_subtype`: VARCHAR(50) (NULL)
- `severity`: VARCHAR(20) (NOT NULL)
- `event_data`: TEXT (NULL)
- `message`: TEXT (NULL)
- `source`: VARCHAR(100) (NULL)
- `latitude`: DOUBLE PRECISION (NULL)
- `longitude`: DOUBLE PRECISION (NULL)
- `altitude`: DOUBLE PRECISION (NULL)
- `event_time`: TIMESTAMP (NOT NULL)
- `processed_at`: TIMESTAMP (NULL)
- `user_id`: UUID (NULL)
- `cared_person_id`: UUID (NULL)
- `device_id`: UUID (NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)
- `is_active`: BOOLEAN (NOT NULL)
- `event_type_id`: INTEGER (NOT NULL)

#### Primary Keys
- `id`

#### Foreign Keys
- `cared_person_id` → `cared_persons.id`
- `device_id` → `devices.id`
- `event_type_id` → `event_types.id`
- `user_id` → `users.id`

#### Indexes
- `ix_events_event_subtype` on `event_subtype`
- `ix_events_event_type_id` on `event_type_id`
- `ix_events_id` on `id`

---

### geofences

#### Columns
- `name`: VARCHAR(200) (NOT NULL)
- `geofence_type`: VARCHAR(50) (NOT NULL)
- `description`: TEXT (NULL)
- `center_latitude`: DOUBLE PRECISION (NOT NULL)
- `center_longitude`: DOUBLE PRECISION (NOT NULL)
- `radius`: DOUBLE PRECISION (NULL)
- `polygon_coordinates`: TEXT (NULL)
- `trigger_action`: VARCHAR(50) (NOT NULL)
- `alert_message`: TEXT (NULL)
- `is_active`: BOOLEAN (NOT NULL)
- `start_time`: TIMESTAMP (NULL)
- `end_time`: TIMESTAMP (NULL)
- `days_of_week`: VARCHAR(50) (NULL)
- `user_id`: UUID (NULL)
- `cared_person_id`: UUID (NULL)
- `institution_id`: INTEGER (NULL)
- `id`: INTEGER (NOT NULL) (AUTO)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)

#### Primary Keys
- `id`

#### Foreign Keys
- `cared_person_id` → `cared_persons.id`
- `institution_id` → `institutions.id`
- `user_id` → `users.id`

#### Indexes
- `ix_geofences_geofence_type` on `geofence_type`
- `ix_geofences_id` on `id`
- `ix_geofences_name` on `name`

---

### institution_reviews

#### Columns
- `id`: UUID (NOT NULL)
- `institution_id`: INTEGER (NOT NULL)
- `reviewer_id`: UUID (NOT NULL)
- `cared_person_id`: UUID (NULL)
- `institution_score_id`: UUID (NULL)
- `rating`: INTEGER (NOT NULL)
- `comment`: TEXT (NULL)
- `categories`: JSONB (NULL)
- `is_recommended`: BOOLEAN (NOT NULL)
- `service_date`: DATE (NULL)
- `is_verified`: BOOLEAN (NOT NULL)
- `is_public`: BOOLEAN (NOT NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NULL)
- `is_active`: BOOLEAN (NOT NULL)
- `service_type_id`: INTEGER (NULL)

#### Primary Keys
- `id`

#### Foreign Keys
- `cared_person_id` → `cared_persons.id`
- `institution_id` → `institutions.id`
- `institution_score_id` → `institution_scores.id`
- `reviewer_id` → `users.id`
- `service_type_id` → `service_types.id`

#### Indexes
- `ix_institution_reviews_cared_person_id` on `cared_person_id`
- `ix_institution_reviews_id` on `id`
- `ix_institution_reviews_institution_id` on `institution_id`
- `ix_institution_reviews_institution_score_id` on `institution_score_id`
- `ix_institution_reviews_reviewer_id` on `reviewer_id`

---

### institution_scores

#### Columns
- `id`: UUID (NOT NULL)
- `institution_id`: INTEGER (NOT NULL)
- `overall_score`: DOUBLE PRECISION (NULL)
- `service_score`: DOUBLE PRECISION (NULL)
- `infrastructure_score`: DOUBLE PRECISION (NULL)
- `compliance_score`: DOUBLE PRECISION (NULL)
- `reputation_score`: DOUBLE PRECISION (NULL)
- `total_reviews`: INTEGER (NOT NULL)
- `total_recommendations`: INTEGER (NOT NULL)
- `total_patients`: INTEGER (NOT NULL)
- `years_operating`: INTEGER (NULL)
- `staff_ratio`: DOUBLE PRECISION (NULL)
- `response_time`: INTEGER (NULL)
- `safety_incidents`: INTEGER (NOT NULL)
- `satisfaction_rate`: DOUBLE PRECISION (NULL)
- `has_medical_license`: BOOLEAN (NOT NULL)
- `has_safety_certification`: BOOLEAN (NOT NULL)
- `has_quality_certification`: BOOLEAN (NOT NULL)
- `last_inspection_date`: DATE (NULL)
- `inspection_score`: DOUBLE PRECISION (NULL)
- `last_calculated`: TIMESTAMP (NULL)
- `last_review`: TIMESTAMP (NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)
- `is_active`: BOOLEAN (NOT NULL)

#### Primary Keys
- `id`

#### Foreign Keys
- `institution_id` → `institutions.id`

#### Indexes
- `ix_institution_scores_id` on `id`
- `ix_institution_scores_institution_id` on `institution_id`

---

### institutions

#### Columns
- `name`: VARCHAR(200) (NOT NULL)
- `description`: TEXT (NULL)
- `institution_type`: VARCHAR(50) (NOT NULL)
- `address`: TEXT (NULL)
- `phone`: VARCHAR(20) (NULL)
- `email`: VARCHAR(100) (NULL)
- `website`: VARCHAR(200) (NULL)
- `latitude`: DOUBLE PRECISION (NULL)
- `longitude`: DOUBLE PRECISION (NULL)
- `tax_id`: VARCHAR(50) (NULL)
- `license_number`: VARCHAR(50) (NULL)
- `capacity`: INTEGER (NULL)
- `is_verified`: BOOLEAN (NOT NULL)
- `id`: INTEGER (NOT NULL) (AUTO)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)
- `is_active`: BOOLEAN (NOT NULL)

#### Primary Keys
- `id`

#### Indexes
- `ix_institutions_id` on `id`
- `ix_institutions_institution_type` on `institution_type`
- `ix_institutions_name` on `name`

---

### location_tracking

#### Columns
- `latitude`: DOUBLE PRECISION (NOT NULL)
- `longitude`: DOUBLE PRECISION (NOT NULL)
- `altitude`: DOUBLE PRECISION (NULL)
- `accuracy`: DOUBLE PRECISION (NULL)
- `speed`: DOUBLE PRECISION (NULL)
- `heading`: DOUBLE PRECISION (NULL)
- `location_name`: VARCHAR(200) (NULL)
- `address`: TEXT (NULL)
- `place_type`: VARCHAR(50) (NULL)
- `tracking_method`: VARCHAR(50) (NULL)
- `battery_level`: INTEGER (NULL)
- `signal_strength`: INTEGER (NULL)
- `recorded_at`: TIMESTAMP (NOT NULL)
- `received_at`: TIMESTAMP (NOT NULL)
- `user_id`: UUID (NULL)
- `cared_person_id`: UUID (NULL)
- `device_id`: UUID (NULL)
- `id`: INTEGER (NOT NULL) (AUTO)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)
- `is_active`: BOOLEAN (NOT NULL)

#### Primary Keys
- `id`

#### Foreign Keys
- `cared_person_id` → `cared_persons.id`
- `device_id` → `devices.id`
- `user_id` → `users.id`

#### Indexes
- `ix_location_tracking_id` on `id`

---

### medical_conditions

#### Columns
- `id`: UUID (NOT NULL)
- `cared_person_id`: UUID (NOT NULL)
- `condition_name`: VARCHAR (NOT NULL)
- `description`: TEXT (NULL)
- `severity_level`: VARCHAR (NULL)
- `diagnosis_date`: DATE (NULL)
- `doctor_name`: VARCHAR (NULL)
- `treatment_plan`: TEXT (NULL)
- `is_active`: BOOLEAN (NOT NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)

#### Primary Keys
- `id`

#### Foreign Keys
- `cared_person_id` → `cared_persons.id`

---

### medical_profiles

#### Columns
- `id`: UUID (NOT NULL)
- `cared_person_id`: UUID (NOT NULL)
- `blood_type`: VARCHAR(10) (NULL)
- `allergies`: TEXT (NULL)
- `chronic_conditions`: TEXT (NULL)
- `emergency_info`: JSONB (NULL)
- `medical_preferences`: JSONB (NULL)
- `insurance_info`: JSONB (NULL)
- `is_active`: BOOLEAN (NOT NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)

#### Primary Keys
- `id`

#### Foreign Keys
- `cared_person_id` → `cared_persons.id`

#### Indexes
- `ix_medical_profiles_id` on `id`
- `medical_profiles_cared_person_id_key` on `cared_person_id` (UNIQUE)

---

### medication_logs

#### Columns
- `id`: UUID (NOT NULL)
- `medication_schedule_id`: UUID (NOT NULL)
- `taken_at`: TIMESTAMP (NOT NULL)
- `confirmed_by`: UUID (NULL)
- `confirmation_method`: VARCHAR(50) (NULL)
- `notes`: TEXT (NULL)
- `attachment`: JSONB (NULL)
- `is_missed`: BOOLEAN (NULL)
- `side_effects`: TEXT (NULL)
- `effectiveness_rating`: VARCHAR(20) (NULL)
- `dosage_given`: VARCHAR(100) (NULL)
- `additional_data`: JSONB (NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)
- `is_active`: BOOLEAN (NOT NULL)

#### Primary Keys
- `id`

#### Foreign Keys
- `confirmed_by` → `users.id`
- `medication_schedule_id` → `medication_schedules.id`

#### Indexes
- `ix_medication_logs_id` on `id`

---

### medication_schedules

#### Columns
- `id`: UUID (NOT NULL)
- `cared_person_id`: UUID (NOT NULL)
- `medication_name`: VARCHAR(200) (NOT NULL)
- `dosage`: VARCHAR(100) (NOT NULL)
- `frequency`: VARCHAR(100) (NOT NULL)
- `start_date`: DATE (NOT NULL)
- `end_date`: DATE (NULL)
- `instructions`: TEXT (NULL)
- `prescribed_by`: UUID (NULL)
- `is_active`: BOOLEAN (NOT NULL)
- `schedule_details`: JSONB (NULL)
- `side_effects`: TEXT (NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)

#### Primary Keys
- `id`

#### Foreign Keys
- `cared_person_id` → `cared_persons.id`
- `prescribed_by` → `users.id`

#### Indexes
- `ix_medication_schedules_id` on `id`

---

### medications

#### Columns
- `id`: UUID (NOT NULL)
- `cared_person_id`: UUID (NOT NULL)
- `medication_name`: VARCHAR (NOT NULL)
- `dosage`: VARCHAR (NULL)
- `frequency`: VARCHAR (NULL)
- `start_date`: DATE (NULL)
- `end_date`: DATE (NULL)
- `prescribed_by`: VARCHAR (NULL)
- `instructions`: TEXT (NULL)
- `is_active`: BOOLEAN (NOT NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)

#### Primary Keys
- `id`

#### Foreign Keys
- `cared_person_id` → `cared_persons.id`

---

### package_add_ons

#### Columns
- `id`: UUID (NOT NULL)
- `name`: VARCHAR(100) (NOT NULL)
- `description`: TEXT (NULL)
- `add_on_type`: VARCHAR(50) (NOT NULL)
- `price_monthly`: INTEGER (NOT NULL)
- `price_yearly`: INTEGER (NULL)
- `configuration`: JSONB (NULL)
- `limitations`: JSONB (NULL)
- `compatible_packages`: JSONB (NULL)
- `max_quantity`: INTEGER (NULL)
- `is_active`: BOOLEAN (NOT NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)

#### Primary Keys
- `id`

#### Indexes
- `ix_package_add_ons_add_on_type` on `add_on_type`
- `ix_package_add_ons_id` on `id`
- `ix_package_add_ons_name` on `name`

---

### packages

#### Columns
- `id`: UUID (NOT NULL)
- `package_type`: VARCHAR(50) (NOT NULL)
- `name`: VARCHAR(100) (NOT NULL)
- `description`: TEXT (NULL)
- `price_monthly`: INTEGER (NOT NULL)
- `price_yearly`: INTEGER (NULL)
- `currency`: VARCHAR(3) (NOT NULL)
- `max_users`: INTEGER (NULL)
- `max_devices`: INTEGER (NULL)
- `max_storage_gb`: INTEGER (NULL)
- `features`: JSONB (NULL)
- `limitations`: JSONB (NULL)
- `customizable_options`: JSONB (NULL)
- `add_ons_available`: JSONB (NULL)
- `base_configuration`: JSONB (NULL)
- `is_customizable`: BOOLEAN (NOT NULL)
- `support_level`: VARCHAR(50) (NULL)
- `response_time_hours`: INTEGER (NULL)
- `is_active`: BOOLEAN (NOT NULL)
- `is_featured`: BOOLEAN (NOT NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)

#### Primary Keys
- `id`

#### Indexes
- `ix_packages_id` on `id`
- `ix_packages_name` on `name`
- `ix_packages_package_type` on `package_type`

---

### referral_commissions

#### Columns
- `id`: UUID (NOT NULL)
- `referral_id`: UUID (NOT NULL)
- `recipient_type`: VARCHAR(20) (NOT NULL)
- `recipient_id`: UUID (NOT NULL)
- `amount`: DOUBLE PRECISION (NOT NULL)
- `commission_type`: VARCHAR(20) (NOT NULL)
- `percentage`: DOUBLE PRECISION (NOT NULL)
- `paid_at`: TIMESTAMP (NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)
- `is_active`: BOOLEAN (NOT NULL)
- `status_type_id`: INTEGER (NULL)

#### Primary Keys
- `id`

#### Foreign Keys
- `referral_id` → `referrals.id`
- `status_type_id` → `status_types.id`

#### Indexes
- `ix_referral_commissions_id` on `id`
- `ix_referral_commissions_status_type_id` on `status_type_id`

---

### referral_types

#### Columns
- `id`: INTEGER (NOT NULL) (AUTO)
- `name`: VARCHAR(50) (NOT NULL)
- `description`: VARCHAR(255) (NULL)
- `category`: VARCHAR(50) (NULL)
- `is_active`: BOOLEAN (NOT NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)

#### Primary Keys
- `id`

#### Indexes
- `ix_referral_types_category` on `category`
- `ix_referral_types_name` on `name` (UNIQUE)

---

### referrals

#### Columns
- `id`: UUID (NOT NULL)
- `referral_code`: VARCHAR(20) (NOT NULL)
- `referrer_type`: VARCHAR(20) (NOT NULL)
- `referrer_id`: UUID (NOT NULL)
- `referred_email`: VARCHAR(100) (NOT NULL)
- `referred_name`: VARCHAR(100) (NULL)
- `referred_phone`: VARCHAR(20) (NULL)
- `registered_at`: TIMESTAMP (NULL)
- `converted_at`: TIMESTAMP (NULL)
- `expired_at`: TIMESTAMP (NULL)
- `commission_amount`: DOUBLE PRECISION (NULL)
- `commission_paid`: BOOLEAN (NULL)
- `commission_paid_at`: TIMESTAMP (NULL)
- `notes`: TEXT (NULL)
- `source`: VARCHAR(50) (NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)
- `is_active`: BOOLEAN (NOT NULL)
- `status_type_id`: INTEGER (NULL)
- `referral_type_id`: INTEGER (NOT NULL)

#### Primary Keys
- `id`

#### Foreign Keys
- `referral_type_id` → `referral_types.id`
- `status_type_id` → `status_types.id`

#### Indexes
- `ix_referrals_id` on `id`
- `ix_referrals_referral_code` on `referral_code` (UNIQUE)
- `ix_referrals_referral_type_id` on `referral_type_id`
- `ix_referrals_status_type_id` on `status_type_id`

---

### relationship_types

#### Columns
- `id`: INTEGER (NOT NULL) (AUTO)
- `name`: VARCHAR(50) (NOT NULL)
- `description`: VARCHAR(255) (NULL)
- `is_active`: BOOLEAN (NOT NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)

#### Primary Keys
- `id`

#### Indexes
- `ix_relationship_types_name` on `name` (UNIQUE)

---

### reminder_types

#### Columns
- `id`: INTEGER (NOT NULL) (AUTO)
- `name`: VARCHAR(50) (NOT NULL)
- `description`: VARCHAR(255) (NULL)
- `category`: VARCHAR(50) (NULL)
- `icon_name`: VARCHAR(50) (NULL)
- `color_code`: VARCHAR(7) (NULL)
- `is_active`: BOOLEAN (NOT NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)

#### Primary Keys
- `id`

#### Indexes
- `ix_reminder_types_category` on `category`
- `ix_reminder_types_name` on `name` (UNIQUE)

---

### reminders

#### Columns
- `id`: UUID (NOT NULL)
- `title`: VARCHAR(200) (NOT NULL)
- `description`: TEXT (NULL)
- `scheduled_time`: TIMESTAMP (NOT NULL)
- `due_date`: DATE (NULL)
- `repeat_pattern`: VARCHAR(100) (NULL)
- `completed_at`: TIMESTAMP (NULL)
- `completed_by`: UUID (NULL)
- `priority`: INTEGER (NOT NULL)
- `is_important`: BOOLEAN (NOT NULL)
- `reminder_data`: TEXT (NULL)
- `notes`: TEXT (NULL)
- `user_id`: UUID (NULL)
- `cared_person_id`: UUID (NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)
- `is_active`: BOOLEAN (NOT NULL)
- `status_type_id`: INTEGER (NULL)
- `reminder_type_id`: INTEGER (NOT NULL)

#### Primary Keys
- `id`

#### Foreign Keys
- `cared_person_id` → `cared_persons.id`
- `completed_by` → `users.id`
- `reminder_type_id` → `reminder_types.id`
- `status_type_id` → `status_types.id`
- `user_id` → `users.id`

#### Indexes
- `ix_reminders_id` on `id`
- `ix_reminders_reminder_type_id` on `reminder_type_id`
- `ix_reminders_status_type_id` on `status_type_id`

---

### report_types

#### Columns
- `id`: INTEGER (NOT NULL) (AUTO)
- `name`: VARCHAR(50) (NOT NULL)
- `description`: VARCHAR(255) (NULL)
- `is_active`: BOOLEAN (NOT NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)

#### Primary Keys
- `id`

#### Indexes
- `ix_report_types_name` on `name` (UNIQUE)

---

### reports

#### Columns
- `id`: UUID (NOT NULL)
- `title`: VARCHAR(255) (NOT NULL)
- `description`: TEXT (NULL)
- `attached_files`: JSONB (NULL)
- `created_at`: TIMESTAMP (NULL)
- `updated_at`: TIMESTAMP (NULL)
- `cared_person_id`: UUID (NULL)
- `created_by_id`: UUID (NOT NULL)
- `is_autocuidado`: BOOLEAN (NULL)
- `report_type_id`: INTEGER (NULL)

#### Primary Keys
- `id`

#### Foreign Keys
- `cared_person_id` → `cared_persons.id`
- `created_by_id` → `users.id`
- `report_type_id` → `report_types.id`

#### Indexes
- `ix_reports_id` on `id`
- `ix_reports_report_type_id` on `report_type_id`

---

### restraint_protocols

#### Columns
- `id`: UUID (NOT NULL)
- `cared_person_id`: UUID (NOT NULL)
- `institution_id`: INTEGER (NULL)
- `created_by_id`: UUID (NOT NULL)
- `protocol_type`: VARCHAR(50) (NOT NULL)
- `title`: VARCHAR(200) (NOT NULL)
- `description`: TEXT (NULL)
- `justification`: TEXT (NOT NULL)
- `risk_assessment`: TEXT (NULL)
- `start_date`: TIMESTAMP (NOT NULL)
- `end_date`: TIMESTAMP (NULL)
- `review_frequency`: VARCHAR(50) (NULL)
- `next_review_date`: TIMESTAMP (NULL)
- `responsible_professional`: VARCHAR(200) (NOT NULL)
- `professional_license`: VARCHAR(100) (NULL)
- `supervising_doctor`: VARCHAR(200) (NULL)
- `compliance_status`: VARCHAR(50) (NOT NULL)
- `last_compliance_check`: TIMESTAMP (NULL)
- `attached_files`: JSONB (NULL)
- `notes`: TEXT (NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NULL)
- `updated_by_id`: UUID (NULL)
- `status_type_id`: INTEGER (NULL)

#### Primary Keys
- `id`

#### Foreign Keys
- `cared_person_id` → `cared_persons.id`
- `created_by_id` → `users.id`
- `institution_id` → `institutions.id`
- `status_type_id` → `status_types.id`
- `updated_by_id` → `users.id`

#### Indexes
- `ix_restraint_protocols_cared_person_id` on `cared_person_id`
- `ix_restraint_protocols_created_by_id` on `created_by_id`
- `ix_restraint_protocols_id` on `id`
- `ix_restraint_protocols_institution_id` on `institution_id`
- `ix_restraint_protocols_protocol_type` on `protocol_type`
- `ix_restraint_protocols_status_type_id` on `status_type_id`

---

### roles

#### Columns
- `id`: UUID (NOT NULL)
- `name`: VARCHAR(50) (NOT NULL)
- `description`: TEXT (NULL)
- `permissions`: TEXT (NULL)
- `is_system`: BOOLEAN (NOT NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)
- `is_active`: BOOLEAN (NOT NULL)

#### Primary Keys
- `id`

#### Indexes
- `ix_roles_id` on `id`
- `ix_roles_name` on `name` (UNIQUE)

---

### service_subscriptions

#### Columns
- `service_name`: VARCHAR(100) (NOT NULL)
- `description`: TEXT (NULL)
- `features`: TEXT (NULL)
- `limitations`: TEXT (NULL)
- `price_per_month`: INTEGER (NULL)
- `price_per_year`: INTEGER (NULL)
- `currency`: VARCHAR(3) (NOT NULL)
- `start_date`: DATE (NOT NULL)
- `end_date`: DATE (NULL)
- `auto_renew`: BOOLEAN (NOT NULL)
- `user_id`: UUID (NULL)
- `institution_id`: INTEGER (NULL)
- `id`: INTEGER (NOT NULL) (AUTO)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)
- `status_type_id`: INTEGER (NULL)
- `service_type_id`: INTEGER (NOT NULL)

#### Primary Keys
- `id`

#### Foreign Keys
- `institution_id` → `institutions.id`
- `service_type_id` → `service_types.id`
- `status_type_id` → `status_types.id`
- `user_id` → `users.id`

#### Indexes
- `ix_service_subscriptions_id` on `id`
- `ix_service_subscriptions_service_name` on `service_name`
- `ix_service_subscriptions_service_type_id` on `service_type_id`
- `ix_service_subscriptions_status_type_id` on `status_type_id`

---

### service_types

#### Columns
- `id`: INTEGER (NOT NULL) (AUTO)
- `name`: VARCHAR(50) (NOT NULL)
- `description`: VARCHAR(255) (NULL)
- `category`: VARCHAR(50) (NULL)
- `is_active`: BOOLEAN (NOT NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)

#### Primary Keys
- `id`

#### Indexes
- `ix_service_types_category` on `category`
- `ix_service_types_name` on `name` (UNIQUE)

---

### shift_observation_types

#### Columns
- `id`: INTEGER (NOT NULL) (AUTO)
- `name`: VARCHAR(50) (NOT NULL)
- `description`: VARCHAR(255) (NULL)
- `category`: VARCHAR(50) (NULL)
- `is_active`: BOOLEAN (NOT NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)

#### Primary Keys
- `id`

#### Indexes
- `ix_shift_observation_types_category` on `category`
- `ix_shift_observation_types_name` on `name` (UNIQUE)

---

### shift_observations

#### Columns
- `id`: UUID (NOT NULL)
- `shift_type`: VARCHAR(50) (NOT NULL)
- `shift_start`: TIMESTAMP (NOT NULL)
- `shift_end`: TIMESTAMP (NOT NULL)
- `observation_date`: TIMESTAMP (NOT NULL)
- `physical_condition`: VARCHAR(50) (NULL)
- `mobility_level`: VARCHAR(50) (NULL)
- `pain_level`: INTEGER (NULL)
- `vital_signs`: JSONB (NULL)
- `skin_condition`: VARCHAR(200) (NULL)
- `mental_state`: VARCHAR(50) (NULL)
- `mood`: VARCHAR(50) (NULL)
- `behavior_notes`: TEXT (NULL)
- `cognitive_function`: VARCHAR(50) (NULL)
- `communication_ability`: VARCHAR(50) (NULL)
- `appetite`: VARCHAR(50) (NULL)
- `food_intake`: VARCHAR(50) (NULL)
- `fluid_intake`: VARCHAR(50) (NULL)
- `swallowing_difficulty`: BOOLEAN (NULL)
- `special_diet_notes`: TEXT (NULL)
- `bowel_movement`: VARCHAR(50) (NULL)
- `urinary_output`: VARCHAR(50) (NULL)
- `incontinence_episodes`: INTEGER (NULL)
- `medications_taken`: JSONB (NULL)
- `medications_missed`: JSONB (NULL)
- `side_effects_observed`: TEXT (NULL)
- `medication_notes`: TEXT (NULL)
- `activities_participated`: JSONB (NULL)
- `social_interaction`: VARCHAR(50) (NULL)
- `exercise_performed`: BOOLEAN (NULL)
- `exercise_details`: TEXT (NULL)
- `safety_concerns`: TEXT (NULL)
- `incidents_occurred`: BOOLEAN (NULL)
- `incident_details`: TEXT (NULL)
- `fall_risk_assessment`: VARCHAR(50) (NULL)
- `restraint_used`: BOOLEAN (NULL)
- `restraint_details`: TEXT (NULL)
- `family_contact`: BOOLEAN (NULL)
- `family_notes`: TEXT (NULL)
- `doctor_contact`: BOOLEAN (NULL)
- `doctor_notes`: TEXT (NULL)
- `handover_notes`: TEXT (NULL)
- `attached_files`: JSONB (NULL)
- `is_verified`: BOOLEAN (NULL)
- `verified_by`: UUID (NULL)
- `verified_at`: TIMESTAMP (NULL)
- `cared_person_id`: UUID (NOT NULL)
- `caregiver_id`: UUID (NOT NULL)
- `institution_id`: INTEGER (NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)
- `is_active`: BOOLEAN (NOT NULL)
- `hygiene_status_type_id`: INTEGER (NULL)
- `catheter_status_type_id`: INTEGER (NULL)
- `status_type_id`: INTEGER (NULL)
- `shift_observation_type_id`: INTEGER (NOT NULL)

#### Primary Keys
- `id`

#### Foreign Keys
- `cared_person_id` → `cared_persons.id`
- `caregiver_id` → `users.id`
- `catheter_status_type_id` → `status_types.id`
- `hygiene_status_type_id` → `status_types.id`
- `institution_id` → `institutions.id`
- `shift_observation_type_id` → `shift_observation_types.id`
- `status_type_id` → `status_types.id`
- `verified_by` → `users.id`

#### Indexes
- `ix_shift_observations_catheter_status_type_id` on `catheter_status_type_id`
- `ix_shift_observations_hygiene_status_type_id` on `hygiene_status_type_id`
- `ix_shift_observations_shift_observation_type_id` on `shift_observation_type_id`
- `ix_shift_observations_status_type_id` on `status_type_id`

---

### status_types

#### Columns
- `id`: INTEGER (NOT NULL) (AUTO)
- `name`: VARCHAR(50) (NOT NULL)
- `description`: TEXT (NULL)
- `category`: VARCHAR(50) (NOT NULL)
- `is_active`: BOOLEAN (NOT NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)

#### Primary Keys
- `id`

#### Indexes
- `ix_status_types_category` on `category`
- `ix_status_types_id` on `id`
- `ix_status_types_name` on `name` (UNIQUE)

---

### user_package_add_ons

#### Columns
- `id`: UUID (NOT NULL)
- `user_package_id`: UUID (NOT NULL)
- `add_on_id`: UUID (NOT NULL)
- `quantity`: INTEGER (NOT NULL)
- `custom_configuration`: JSONB (NULL)
- `current_amount`: INTEGER (NOT NULL)
- `billing_cycle`: VARCHAR(20) (NOT NULL)
- `added_at`: TIMESTAMP (NOT NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)
- `status_type_id`: INTEGER (NULL)

#### Primary Keys
- `id`

#### Foreign Keys
- `add_on_id` → `package_add_ons.id`
- `status_type_id` → `status_types.id`
- `user_package_id` → `user_packages.id`

#### Indexes
- `ix_user_package_add_ons_id` on `id`
- `ix_user_package_add_ons_status_type_id` on `status_type_id`

---

### user_packages

#### Columns
- `id`: UUID (NOT NULL)
- `user_id`: UUID (NOT NULL)
- `package_id`: UUID (NOT NULL)
- `start_date`: DATE (NOT NULL)
- `end_date`: DATE (NULL)
- `auto_renew`: BOOLEAN (NOT NULL)
- `billing_cycle`: VARCHAR(20) (NOT NULL)
- `current_amount`: INTEGER (NOT NULL)
- `next_billing_date`: DATE (NOT NULL)
- `custom_configuration`: JSONB (NULL)
- `selected_features`: JSONB (NULL)
- `custom_limits`: JSONB (NULL)
- `legal_capacity_verified`: BOOLEAN (NOT NULL)
- `legal_representative_id`: UUID (NULL)
- `verification_date`: TIMESTAMP (NULL)
- `referral_code_used`: VARCHAR(20) (NULL)
- `referral_commission_applied`: BOOLEAN (NOT NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)
- `status_type_id`: INTEGER (NULL)

#### Primary Keys
- `id`

#### Foreign Keys
- `legal_representative_id` → `users.id`
- `package_id` → `packages.id`
- `status_type_id` → `status_types.id`
- `user_id` → `users.id`

#### Indexes
- `ix_user_packages_id` on `id`
- `ix_user_packages_status_type_id` on `status_type_id`

---

### user_roles

#### Columns
- `user_id`: UUID (NOT NULL)
- `role_id`: UUID (NOT NULL)
- `assigned_at`: TIMESTAMP (NOT NULL)
- `assigned_by`: UUID (NULL)
- `expires_at`: TIMESTAMP (NULL)
- `is_active`: BOOLEAN (NOT NULL)
- `id`: INTEGER (NOT NULL) (AUTO)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)

#### Primary Keys
- `id`

#### Foreign Keys
- `assigned_by` → `users.id`
- `role_id` → `roles.id`
- `user_id` → `users.id`

#### Indexes
- `ix_user_roles_id` on `id`
- `ix_user_roles_role_id` on `role_id`
- `ix_user_roles_user_id` on `user_id`

---

### users

#### Columns
- `id`: UUID (NOT NULL)
- `email`: VARCHAR(100) (NOT NULL)
- `username`: VARCHAR(50) (NULL)
- `password_hash`: VARCHAR(255) (NOT NULL)
- `first_name`: VARCHAR(100) (NOT NULL)
- `last_name`: VARCHAR(100) (NULL)
- `phone`: VARCHAR(20) (NULL)
- `date_of_birth`: TIMESTAMP (NULL)
- `gender`: VARCHAR(20) (NULL)
- `professional_license`: VARCHAR(50) (NULL)
- `specialization`: VARCHAR(100) (NULL)
- `experience_years`: INTEGER (NULL)
- `is_freelance`: BOOLEAN (NOT NULL)
- `hourly_rate`: INTEGER (NULL)
- `availability`: TEXT (NULL)
- `is_verified`: BOOLEAN (NOT NULL)
- `is_active`: BOOLEAN (NOT NULL)
- `last_login`: TIMESTAMP (NULL)
- `institution_id`: INTEGER (NULL)
- `created_at`: TIMESTAMP (NOT NULL)
- `updated_at`: TIMESTAMP (NOT NULL)

#### Primary Keys
- `id`

#### Foreign Keys
- `institution_id` → `institutions.id`

#### Indexes
- `ix_users_email` on `email` (UNIQUE)
- `ix_users_id` on `id`
- `ix_users_username` on `username` (UNIQUE)

---

## Foreign Key Relationships

### alerts

- `alert_type_id` → `alert_types.id`
- `cared_person_id` → `cared_persons.id`
- `device_id` → `devices.id`
- `event_id` → `events.id`
- `status_type_id` → `status_types.id`
- `user_id` → `users.id`

### allergies

- `cared_person_id` → `cared_persons.id`

### billing_records

- `institution_id` → `institutions.id`
- `service_subscription_id` → `service_subscriptions.id`
- `status_type_id` → `status_types.id`
- `user_id` → `users.id`
- `user_package_id` → `user_packages.id`

### cared_person_institutions

- `cared_person_id` → `cared_persons.id`
- `institution_id` → `institutions.id`
- `registered_by` → `users.id`
- `service_type_id` → `service_types.id`
- `status_type_id` → `status_types.id`

### cared_persons

- `care_type_id` → `care_types.id`
- `institution_id` → `institutions.id`
- `user_id` → `users.id`

### caregiver_assignments

- `assigned_by` → `users.id`
- `cared_person_id` → `cared_persons.id`
- `caregiver_assignment_type_id` → `caregiver_assignment_types.id`
- `caregiver_id` → `users.id`
- `status_type_id` → `status_types.id`

### caregiver_institutions

- `caregiver_id` → `users.id`
- `hired_by` → `users.id`
- `institution_id` → `institutions.id`
- `relationship_type_id` → `relationship_types.id`
- `status_type_id` → `status_types.id`

### caregiver_reviews

- `cared_person_id` → `cared_persons.id`
- `caregiver_id` → `users.id`
- `caregiver_score_id` → `caregiver_scores.id`
- `reviewer_id` → `users.id`
- `service_type_id` → `service_types.id`

### caregiver_scores

- `caregiver_id` → `users.id`

### debug_events

- `cared_person_id` → `cared_persons.id`
- `device_id` → `devices.id`
- `user_id` → `users.id`

### device_configs

- `applied_by` → `users.id`
- `device_id` → `devices.id`

### devices

- `cared_person_id` → `cared_persons.id`
- `device_type_id` → `device_types.id`
- `institution_id` → `institutions.id`
- `status_type_id` → `status_types.id`
- `user_id` → `users.id`

### diagnoses

- `cared_person_id` → `cared_persons.id`
- `created_by_id` → `users.id`
- `updated_by_id` → `users.id`

### emergency_protocols

- `institution_id` → `institutions.id`

### events

- `cared_person_id` → `cared_persons.id`
- `device_id` → `devices.id`
- `event_type_id` → `event_types.id`
- `user_id` → `users.id`

### geofences

- `cared_person_id` → `cared_persons.id`
- `institution_id` → `institutions.id`
- `user_id` → `users.id`

### institution_reviews

- `cared_person_id` → `cared_persons.id`
- `institution_id` → `institutions.id`
- `institution_score_id` → `institution_scores.id`
- `reviewer_id` → `users.id`
- `service_type_id` → `service_types.id`

### institution_scores

- `institution_id` → `institutions.id`

### location_tracking

- `cared_person_id` → `cared_persons.id`
- `device_id` → `devices.id`
- `user_id` → `users.id`

### medical_conditions

- `cared_person_id` → `cared_persons.id`

### medical_profiles

- `cared_person_id` → `cared_persons.id`

### medication_logs

- `confirmed_by` → `users.id`
- `medication_schedule_id` → `medication_schedules.id`

### medication_schedules

- `cared_person_id` → `cared_persons.id`
- `prescribed_by` → `users.id`

### medications

- `cared_person_id` → `cared_persons.id`

### referral_commissions

- `referral_id` → `referrals.id`
- `status_type_id` → `status_types.id`

### referrals

- `referral_type_id` → `referral_types.id`
- `status_type_id` → `status_types.id`

### reminders

- `cared_person_id` → `cared_persons.id`
- `completed_by` → `users.id`
- `reminder_type_id` → `reminder_types.id`
- `status_type_id` → `status_types.id`
- `user_id` → `users.id`

### reports

- `cared_person_id` → `cared_persons.id`
- `created_by_id` → `users.id`
- `report_type_id` → `report_types.id`

### restraint_protocols

- `cared_person_id` → `cared_persons.id`
- `created_by_id` → `users.id`
- `institution_id` → `institutions.id`
- `status_type_id` → `status_types.id`
- `updated_by_id` → `users.id`

### service_subscriptions

- `institution_id` → `institutions.id`
- `service_type_id` → `service_types.id`
- `status_type_id` → `status_types.id`
- `user_id` → `users.id`

### shift_observations

- `cared_person_id` → `cared_persons.id`
- `caregiver_id` → `users.id`
- `catheter_status_type_id` → `status_types.id`
- `hygiene_status_type_id` → `status_types.id`
- `institution_id` → `institutions.id`
- `shift_observation_type_id` → `shift_observation_types.id`
- `status_type_id` → `status_types.id`
- `verified_by` → `users.id`

### user_package_add_ons

- `add_on_id` → `package_add_ons.id`
- `status_type_id` → `status_types.id`
- `user_package_id` → `user_packages.id`

### user_packages

- `legal_representative_id` → `users.id`
- `package_id` → `packages.id`
- `status_type_id` → `status_types.id`
- `user_id` → `users.id`

### user_roles

- `assigned_by` → `users.id`
- `role_id` → `roles.id`
- `user_id` → `users.id`

### users

- `institution_id` → `institutions.id`

